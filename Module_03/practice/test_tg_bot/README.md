# Telegram Bot with OpenRouter LLM

Этот бот использует OpenRouter для подключения к различным LLM (модель настраивается в `.env`).

## Установка

1. **Клонируйте репозиторий:**
   ```bash
   git clone https://github.com/sekachev/agentic_ai.git
   cd agentic_ai/Module_03/practice/test_tg_bot
   ```

2. **Установите зависимости и создайте файл настроек:**
   ```bash
   npm install
   cp .env.example .env
   ```

## Требования

Для работы бота необходимо установить **Node.js** (версия 18 или выше).

### Установка Node.js:

#### Для macOS:
1. **Через Homebrew** (рекомендуется):
   ```bash
   brew install node
   ```
2. **Через официальный сайт**:
   Скачайте установщик `.pkg` с [nodejs.org](https://nodejs.org/).

#### Для Windows:
1. Перейдите на [nodejs.org](https://nodejs.org/).
2. Скачайте программу установки **LTS** (Recommended for Most Users).
3. Запустите `.msi` файл и следуйте инструкциям (убедитесь, что галочка "Add to PATH" установлена).

---

## Настройка

1. Откройте файл `.env`.
2. В файле `.env` укажите:
   - `TELEGRAM_BOT_TOKEN`: Токен вашего бота от [@BotFather](https://t.me/BotFather).
   - `OPENROUTER_API_KEY`: Ваш API ключ от [OpenRouter](https://openrouter.ai/).
   - `OPENROUTER_MODEL`: (Опционально) Модель, которую вы хотите использовать (например, `xiaomi/mimo-v2-flash:free`).

3. Промпты ролей находятся в файле `roles.json`. Вы можете добавлять новые роли или изменять существующие.

## Команды бота

- `/start` — Начало работы и приветствие.
- `/role` — Выбор личности бота через интерактивное меню (влияет на стиль ответов).
- `/summary` — Создание краткого пересказа текущей переписки.

## Особенности

- **Контекст общения**: Бот помнит последние 10 сообщений в текущей сессии.
- **Смена ролей**: При выборе новой роли в историю добавляется системная инструкция, что позволяет боту плавно менять стиль общения, сохраняя нить разговора.
- **Логирование**: Все запросы и ответы записываются в `bot.log`.

## Запуск

Запустите бота:
```bash
node index.js
```

## Структура проекта

- `index.js`: Основной код бота и логика команд.
- `roles.json`: Конфигурация ролей и системных промптов.
- `bot.log`: Файл с логами переписки.
- `.env`: Конфигурация (токены и ключи).
- `package.json`: Зависимости.
