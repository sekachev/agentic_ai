# ๐ ะะปะฐะฒะฐ 2: IP, DNS ะธ ะัะพะบัะธัะพะฒะฐะฝะธะต (Nginx)

ะญัะฐ ะณะปะฐะฒะฐ โ ััะฝะดะฐะผะตะฝั ะฟะพะฝะธะผะฐะฝะธั ัะพะณะพ, **ะบะฐะบ ะธะฝัะตัะฝะตั ะฝะฐัะพะดะธั ะฒะฐั ัะฐะนั** ะธ **ะบะฐะบ ะพะดะธะฝ ัะตัะฒะตั ะผะพะถะตั ัะฟัะฐะฒะปััั ะฝะตัะบะพะปัะบะธะผะธ ะฐะดัะตัะฐะผะธ**.

---

## ๐ ะงะฐััั 1: IP-ะฐะดัะตั โ ััะพ ะฒะฐั "ะะพััะพะฒัะน ะธะฝะดะตะบั"

---
### ะงัะพ ัะฐะบะพะต IP-ะฐะดัะตั?

**IP (Internet Protocol)** โ ััะพ ัะธัะปะพะฒะพะน ะฐะดัะตั ะบะพะผะฟัััะตัะฐ ะฒ ะธะฝัะตัะฝะตัะต.

ะะฝะฐะปะพะณะธั: ะญัะพ ะบะฐะบ ะฐะดัะตั ะดะพะผะฐ ะฒ ัะตะฐะปัะฝะพะผ ะผะธัะต.
*   **ะะฐะทะฒะฐะฝะธะต ัะปะธัั (ะดะพะผะตะฝ):** `google.com` โ ััะพ ะบัะฐัะธะฒะพ ะธ ะปะตะณะบะพ ะทะฐะฟะพะผะฝะธัั.
*   **ะะพััะพะฒัะน ะธะฝะดะตะบั (IP):** `142.250.185.46` โ ะผะฐัะธะฝะฐะผ ะฝัะถะฝั ัะพัะฝัะต ะบะพะพัะดะธะฝะฐัั.

---

### ะะฐะบ ัะทะฝะฐัั ัะฒะพะน IP?

ะะฐ ัะตัะฒะตัะต ะฒัะฟะพะปะฝะธัะต ะบะพะผะฐะฝะดั:
```bash
ip a
# ะธะปะธ ะฟะพะปะฝะฐั ะบะพะผะฐะฝะดะฐ
ip addr show
```
ะั ะฟะพะปััะธัะต ััะพ-ัะพ ะฒัะพะดะต: `123.45.67.89` โ ััะพ **ะฒะฝะตัะฝะธะน IP ะฒะฐัะตะณะพ VPS**.

> **ะะฐะถะฝะพ:** ะญัะพั IP ัะฝะธะบะฐะปะตะฝ ะฒ ะธะฝัะตัะฝะตัะต. ะงะตัะตะท ะฝะตะณะพ ะผะพะถะฝะพ ะฟะพะฟะฐััั ะฝะฐ ะฒะฐั ัะตัะฒะตั ะธะท ะปัะฑะพะน ัะพัะบะธ ะผะธัะฐ.

---

## ๐ ะงะฐััั 2: DNS โ ัะตะปะตัะพะฝะฝะฐั ะบะฝะธะณะฐ ะธะฝัะตัะฝะตัะฐ

### ะะฐัะตะผ ะฝัะถะตะฝ DNS?

ะัะดะธ ะฟะปะพัะพ ะทะฐะฟะพะผะธะฝะฐัั ัะธััั, ะฝะพ ัะพัะพัะพ ะฟะพะผะฝัั ัะปะพะฒะฐ.  
**DNS (Domain Name System)** ะฟัะตะฒัะฐัะฐะตั ัะตะปะพะฒะตัะตัะบะธะต ะธะผะตะฝะฐ (`api.tatiana.qix.ee`) ะฒ ะผะฐัะธะฝะฝัะต ะฐะดัะตัะฐ (`123.45.67.89`).

---
### ะะฐะบ ััะพ ัะฐะฑะพัะฐะตั?

1.  ะั ะฒะฒะพะดะธัะต ะฒ ะฑัะฐัะทะตัะต: `https://api.tatiana.qix.ee`
2.  ะัะฐัะทะตั ัะฟัะฐัะธะฒะฐะตั DNS-ัะตัะฒะตั: *"ะะฐะบะพะน IP ั ััะพะณะพ ะดะพะผะตะฝะฐ?"*
3.  DNS ะพัะฒะตัะฐะตั: *"ะญัะพ 123.45.67.89"*
4.  ะัะฐัะทะตั ะฟะพะดะบะปััะฐะตััั ะบ ัะตัะฒะตัั ะฟะพ ััะพะผั IP.

---

### DNS-ะทะฐะฟะธัะธ (ัะธะฟั ัะบะฐะทะฐัะตะปะตะน)

ะ ะฟะฐะฝะตะปะธ ัะฟัะฐะฒะปะตะฝะธั ะดะพะผะตะฝะพะผ (ะฝะฐะฟัะธะผะตั, Cloudflare ะธะปะธ ัะตะณะธัััะฐัะพั) ะฒั ะฝะฐัััะฐะธะฒะฐะตัะต **DNS-ะทะฐะฟะธัะธ**:

| ะขะธะฟ ะทะฐะฟะธัะธ | ะะฐะทะฝะฐัะตะฝะธะต                        | ะัะธะผะตั                                  |
|------------|-----------------------------------|-----------------------------------------|
| **A**      | ะฃะบะฐะทัะฒะฐะตั ะฝะฐ IPv4-ะฐะดัะตั ัะตัะฒะตัะฐ   | `api.tatiana.qix.ee` โ `123.45.67.89`   |
| **CNAME**  | ะัะตะฒะดะพะฝะธะผ (ะฟะตัะตะฝะฐะฟัะฐะฒะปะตะฝะธะต)       | `www.site.com` โ `site.com`             |
| **MX**     | ะะปั ะฟะพััะพะฒัั ัะตัะฒะตัะพะฒ             | (ะฝะฐะผ ะฝะต ะฝัะถะฝะพ ะฒ ััะพะผ ะบัััะต)             |

---

## ๐ฆ ะงะฐััั 3: ะัะพะฑะปะตะผะฐ โ ะพะดะธะฝ IP, ะผะฝะพะณะพ ัะฐะนัะพะฒ

### ะกะธััะฐัะธั

ะฃ ะฒะฐั **ะพะดะธะฝ ัะตัะฒะตั** ั IP `123.45.67.89`, ะฝะพ ะฒั ัะพัะธัะต ัะฐะทะผะตััะธัั ะฝะฐ ะฝัะผ:
*   `https://api.tatiana.qix.ee` โ ะฒะฐั API (FastAPI ะฝะฐ ะฟะพััั 8000)
*   `https://tatiana.qix.ee` โ ะฒะฐั ััะพะฝัะตะฝะด (ััะฐัะธัะตัะบะธะต ัะฐะนะปั)
*   `https://panel.tatiana.qix.ee` โ ะฟะฐะฝะตะปั Cockpit (ะฟะพัั 9090)

**ะัะพะฑะปะตะผะฐ:** ะัะฐัะทะตั ะฟะพะดะบะปััะฐะตััั ะบ ัะตัะฒะตัั ะฟะพ IP, ะฝะพ ะบะฐะบ ัะตัะฒะตั ัะทะฝะฐะตั, ะบะฐะบะพะน ะธะผะตะฝะฝะพ ัะฐะนั ะฟะพะบะฐะทะฐัั?

---

## ๐ ะงะฐััั 4: Nginx โ ัะผะฝัะน ัะฒะตะนัะฐั (Reverse Proxy)

### ะงัะพ ัะฐะบะพะต Nginx?

**Nginx** โ ััะพ ะฟัะพะณัะฐะผะผะฐ-ะฟะพััะตะดะฝะธะบ, ะบะพัะพัะฐั:
1.  ะัััะตัะฐะตั **ะฒัะต ะฒัะพะดััะธะต ะทะฐะฟัะพัั** (ะฝะฐ ะฟะพััั 80 ะธ 443).
2.  ะกะผะพััะธั ะฝะฐ **ะธะผั ะดะพะผะตะฝะฐ** ะฒ ะทะฐะฟัะพัะต (`api.tatiana.qix.ee` ะธะปะธ `tatiana.qix.ee`).
3.  **ะะตัะตะฝะฐะฟัะฐะฒะปัะตั** (ะฟัะพะบัะธััะตั) ะทะฐะฟัะพั ะฝัะถะฝะพะผั ะฟัะธะปะพะถะตะฝะธั:
    *   ะัะปะธ ะดะพะผะตะฝ `api.*` โ ะพัะฟัะฐะฒะปัะตั ะฝะฐ ะฟะพัั 8000 (FastAPI)
    *   ะัะปะธ ะดะพะผะตะฝ ะฑะตะท `api` โ ะพัะดะฐะตั ัะฐะนะปั ะธะท ะฟะฐะฟะบะธ `/var/www/html`
    *   ะัะปะธ ะดะพะผะตะฝ `panel.*` โ ะพัะฟัะฐะฒะปัะตั ะฝะฐ ะฟะพัั 9090 (Cockpit)

---
### ะะฝะฐะปะพะณะธั: ะจะฒะตะนัะฐั ะฒ ะพัะตะปะต

ะัะตะดััะฐะฒััะต **ะพัะตะปั** (ะฒะฐั ัะตัะฒะตั):
*   ะัะต ะณะพััะธ (ะทะฐะฟัะพัั) ะทะฐัะพะดัั ัะตัะตะท **ะณะปะฐะฒะฝัะน ะฒัะพะด** (Nginx).
*   **ะจะฒะตะนัะฐั** ัะฟัะฐัะธะฒะฐะตั: *"ะั ะบ ะบะพะผั?"*
    *   *"ะ API"* โ ะฝะฐะฟัะฐะฒะปัะตั ะฒ ะบะพะผะฝะฐัั 8000.
    *   *"ะะฐ ัะฐะนั"* โ ะพัะดะฐะตั ะฑัะพัััั ะธะท ะฟะฐะฟะบะธ (ััะฐัะธะบะฐ).
    *   *"ะ ะฐะดะผะธะฝะบั"* โ ะพัะฟัะฐะฒะปัะตั ะฒ ะบะพะผะฝะฐัั 9090.

---

## โ๏ธ ะงะฐััั 5: ะะฐะบ ัะฐะฑะพัะฐะตั ะบะพะฝัะธะณััะฐัะธั Nginx

### ะคะฐะนะป ะบะพะฝัะธะณััะฐัะธะธ

Nginx ัะธัะฐะตั ะธะฝััััะบัะธะธ ะธะท ัะฐะนะปะพะฒ ะฒ ะฟะฐะฟะบะต `/etc/nginx/sites-enabled/`.

---


ะัะธะผะตั ะบะพะฝัะธะณะฐ ะดะปั **API**:
```nginx
server {
    listen 80;
    server_name api.tatiana.qix.ee;

    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

---

### ะะฐะทะฑะพั ัััะพะบ:
*   **`listen 80;`** โ ะกะปััะฐะน ะฒัะพะดััะธะต ะฟะพะดะบะปััะตะฝะธั ะฝะฐ ะฟะพััั 80 (HTTP).
*   **`server_name api.tatiana.qix.ee;`** โ ะญัะฐ ะบะพะฝัะธะณััะฐัะธั ััะฐะฑะฐััะฒะฐะตั, ะตัะปะธ ะทะฐะฟัะพั ะฟัะธัะตะป ะฝะฐ ะดะพะผะตะฝ `api.tatiana.qix.ee`.
*   **`proxy_pass http://127.0.0.1:8000;`** โ ะะตัะตัะปะธ ะทะฐะฟัะพั ะฝะฐ ะปะพะบะฐะปัะฝัะน ะฟะพัั 8000 (ะณะดะต ัะฐะฑะพัะฐะตั FastAPI).
*   **`proxy_set_header`** โ ะะตัะตะดะฐะตะผ ะดะพะฟะพะปะฝะธัะตะปัะฝัั ะธะฝัะพัะผะฐัะธั (ะบัะพ ัะฟัะฐัะธะฒะฐะป, ะบะฐะบะพะน ะดะพะผะตะฝ).

---

## ๐ ะงะฐััั 6: ะัะฐะบัะธัะตัะบะฐั ะฝะฐัััะพะนะบะฐ (ะะพัะฐะณะพะฒะพ)

### ะจะฐะณ 1: ะัะพะฒะตัะธัั ััะฐััั Nginx
```bash
systemctl status nginx
```
๐ข ะะพะปะถะฝะพ ะฑััั **active (running)**.

---

### ะจะฐะณ 2: ะกะพะทะดะฐัั ะบะพะฝัะธะณ ะดะปั API
ะัะบัะพะนัะต ัะตะดะฐะบัะพั:
```bash
nano /etc/nginx/sites-available/api
```

ะััะฐะฒััะต ัะพะดะตัะถะธะผะพะต:
```nginx
server {
    listen 80;
    server_name api.ะฒะฐัะต_ะธะผั.qix.ee;

    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

ะกะพััะฐะฝะธัะต: `Ctrl+O`, ะทะฐัะตะผ `Enter`. ะัะนะดะธัะต: `Ctrl+X`.


---

### ะจะฐะณ 3: ะะบัะธะฒะธัะพะฒะฐัั ะบะพะฝัะธะณ
ะกะพะทะดะฐะนัะต ัะธะผะฒะพะปะธัะตัะบัั ัััะปะบั (ััะพ ะบะฐะบ ััะปัะบ ะฒ Windows):
```bash
ln -s /etc/nginx/sites-available/api /etc/nginx/sites-enabled/
```

---


### ะจะฐะณ 4: ะัะพะฒะตัะธัั ัะธะฝัะฐะบัะธั
ะะตัะตะด ะฟะตัะตะทะฐะณััะทะบะพะน ัะฑะตะดะธัะตัั, ััะพ ะฝะตั ะพัะธะฑะพะบ:
```bash
nginx -t
```
โ ะะพะปะถะฝะพ ะฑััั: `syntax is ok` ะธ `test is successful`.

---


### ะจะฐะณ 5: ะะตัะตะทะฐะณััะทะธัั Nginx
```bash
systemctl reload nginx
```

---

## ๐ ะงะฐััั 7: HTTPS ะธ SSL (Certbot)

ะะพ ัะผะพะปัะฐะฝะธั ะฒะฐั ัะฐะนั ัะฐะฑะพัะฐะตั ะฟะพ HTTP (ะฝะตะทะฐัะธััะพะฒะฐะฝะฝะพะผั ะฟัะพัะพะบะพะปั).  
ะงัะพะฑั ะฒะบะปััะธัั **HTTPS** (ะทะฐะผะพัะตะบ ะฒ ะฑัะฐัะทะตัะต), ะธัะฟะพะปัะทัะตััั ะธะฝััััะผะตะฝั **Certbot**.


---
### ะะฒัะพะผะฐัะธัะตัะบะฐั ัััะฐะฝะพะฒะบะฐ ัะตััะธัะธะบะฐัะฐ
```bash
certbot --nginx -d api.ะฒะฐัะต_ะธะผั.qix.ee
```

Certbot:
1.  ะะพะปััะธั ะฑะตัะฟะปะฐัะฝัะน SSL-ัะตััะธัะธะบะฐั ะพั **Let's Encrypt**.
2.  ะะฒัะพะผะฐัะธัะตัะบะธ ะธะทะผะตะฝะธั ะฒะฐั ะบะพะฝัะธะณ Nginx, ะดะพะฑะฐะฒะธะฒ `listen 443 ssl;`.
3.  ะะฐัััะพะธั ะฐะฒัะพะผะฐัะธัะตัะบะพะต ะฟะตัะตะฝะฐะฟัะฐะฒะปะตะฝะธะต ั HTTP ะฝะฐ HTTPS.

> **ะะฐะถะฝะพ:** ะกะตััะธัะธะบะฐัั ะพะฑะฝะพะฒะปััััั ะฐะฒัะพะผะฐัะธัะตัะบะธ ะบะฐะถะดัะต 90 ะดะฝะตะน.

---

## ๐ ะัะพะณะพะฒะฐั ััะตะผะฐ

```
[ะัะฐัะทะตั ะฟะพะปัะทะพะฒะฐัะตะปั]
        โ
   ๐ DNS ะทะฐะฟัะพั: api.tatiana.qix.ee
        โ
   ๐ ะะพะปััะตะฝ IP: 123.45.67.89
        โ
   ๐ HTTPS ะทะฐะฟัะพั ะฝะฐ ะฟะพัั 443
        โ
   ๐ฆ Nginx (ะฟัะพะฒะตััะตั server_name)
        โ
   โ proxy_pass โ http://127.0.0.1:8000
        โ
   ๐ FastAPI ะพะฑัะฐะฑะฐััะฒะฐะตั ะทะฐะฟัะพั
        โ
   ๐ค ะัะฒะตั ะฒะพะทะฒัะฐัะฐะตััั ัะตัะตะท Nginx
        โ
   ๐ ะัะฐัะทะตั ะฟะพะบะฐะทัะฒะฐะตั ัะตะทัะปััะฐั
```

---

## ๐ฏ ะัะพะณ: ะะฐัะตะผ ะฒัั ััะพ ะฝัะถะฝะพ?

| ะขะตัะฝะพะปะพะณะธั | ะะพะปั                                           |
|------------|------------------------------------------------|
| **IP**     | ะคะธะทะธัะตัะบะธะน ะฐะดัะตั ัะตัะฒะตัะฐ ะฒ ะธะฝัะตัะฝะตัะต           |
| **DNS**    | ะัะตะฒัะฐัะฐะตั ะธะผะตะฝะฐ ะฒ IP (ัะตะปะพะฒะตะบ โ ะผะฐัะธะฝะฐ)       |
| **Nginx**  | ะฃะผะฝัะน ะผะฐัััััะธะทะฐัะพั (ะพะดะธะฝ ะฒัะพะด, ะผะฝะพะณะพ ะฒััะพะดะพะฒ) |
| **SSL**    | ะจะธััะพะฒะฐะฝะธะต ะดะฐะฝะฝัั (ะทะฐะผะพัะตะบ ะฒ ะฑัะฐัะทะตัะต)         |
